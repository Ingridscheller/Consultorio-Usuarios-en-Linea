package db;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;
import java.util.logging.Level;
import java.util.logging.Logger;

public class ConexionDB {
    
    private String DB_driver;
    private String url;
    private String db;
    private String host;
    private String username;
    private String password;
    private Connection con;
    private Statement stmt;
    private ResultSet rs;
            
    public ConexionDB(){
        DB_driver= "com.mysql.jdbc.Driver";
        db = "consultorio en linea";
        host = "localhost:3306";
        username = "root";
        password = "root";
        url = "jdbc:mysql://"+ host + "/" + db;
     
        
        try{
            Class.forName(DB_driver);
        }catch(ClassNotFoundException ex){
            Logger.getLogger(ConexionDB.class.getName()).log(Level.SEVERE,null, ex);
        }
        try{
            con = DriverManager.getConnection(url, username, password);
            con.setTransactionIsolation(8);
            System.out.println("BD conectada");
        }catch(SQLException ex){
            Logger.getLogger(ConexionDB.class.getName()).log(Level.SEVERE,null, ex);
        }
    }
    public Connection getconnection(){
         try{
            con.setAutoCommit(true);
            return con;
         }catch(SQLException ex){
            Logger.getLogger(ConexionDB.class.getName()).log(Level.SEVERE,null, ex);
            return null;
        }
    }
    public void closeConnection(Connection con){
         try{
            con.close();
         }catch(SQLException ex){
            Logger.getLogger(ConexionDB.class.getName()).log(Level.SEVERE,null, ex);
            
        }     
    }
    
    public boolean commitDB(){
         try{
            con.commit();
            return true;
         }catch(SQLException ex){
            Logger.getLogger(ConexionDB.class.getName()).log(Level.SEVERE,null, ex);
            return false;            
        } 
    }    
     public boolean rollbackDB(){
         try{
            con.rollback();
            return true;
         }catch(SQLException ex){
            Logger.getLogger(ConexionDB.class.getName()).log(Level.SEVERE,null, ex);
            return false;            
        }     
}         
}           